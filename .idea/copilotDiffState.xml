<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/model/Article.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/model/Article.java" />
              <option name="originalContent" value="package com.example.notby.data.model;&#10;&#10;import com.google.gson.JsonElement;&#10;import com.google.gson.JsonObject;&#10;import com.google.gson.annotations.SerializedName;&#10;import java.util.List;&#10;&#10;public class Article {&#10;    @SerializedName(&quot;_id&quot;)&#10;    private String id;&#10;&#10;    @SerializedName(&quot;CategoryId&quot;)&#10;    private String categoryId;&#10;&#10;    @SerializedName(&quot;Title&quot;)&#10;    private String title;&#10;&#10;    @SerializedName(&quot;Content&quot;)&#10;    private String content;&#10;&#10;    @SerializedName(&quot;FileId&quot;)&#10;    private String fileId;&#10;&#10;    @SerializedName(&quot;Author&quot;)&#10;    private JsonElement author; // can be String, object, or null&#10;&#10;    @SerializedName(&quot;Description&quot;)&#10;    private String description;&#10;&#10;    @SerializedName(&quot;File&quot;)&#10;    private MediaFile file;&#10;&#10;    @SerializedName(&quot;Category&quot;)&#10;    private Category category;&#10;&#10;    @SerializedName(&quot;Likes&quot;)&#10;    private int likes;&#10;&#10;    @SerializedName(&quot;Views&quot;)&#10;    private int views;&#10;&#10;    @SerializedName(&quot;Tags&quot;)&#10;    private List&lt;String&gt; tags;&#10;&#10;    @SerializedName(&quot;ReadTime&quot;)&#10;    private int readTime;&#10;&#10;    @SerializedName(&quot;created_at&quot;)&#10;    private String createdAt;&#10;&#10;    @SerializedName(&quot;updated_at&quot;)&#10;    private String updatedAt;&#10;&#10;    // Getters&#10;    public String getId() { return id; }&#10;    public String getCategoryId() { return categoryId; }&#10;    public String getTitle() { return title; }&#10;    public String getContent() { return content; }&#10;    public String getFileId() { return fileId; }&#10;    public String getAuthorId() {&#10;        if (author == null || author.isJsonNull()) return null;&#10;        if (author.isJsonPrimitive()) {&#10;            try { return author.getAsString(); } catch (Exception e) { return null; }&#10;        }&#10;        if (author.isJsonObject()) {&#10;            JsonObject obj = author.getAsJsonObject();&#10;            if (obj.has(&quot;_id&quot;) &amp;&amp; !obj.get(&quot;_id&quot;).isJsonNull()) return obj.get(&quot;_id&quot;).getAsString();&#10;            if (obj.has(&quot;id&quot;) &amp;&amp; !obj.get(&quot;id&quot;).isJsonNull()) return obj.get(&quot;id&quot;).getAsString();&#10;        }&#10;        return null;&#10;    }&#10;    public String getDescription() { return description; }&#10;    public MediaFile getFile() { return file; }&#10;    public Category getCategory() { return category; }&#10;    public int getLikes() { return likes; }&#10;    public int getViews() { return views; }&#10;    public List&lt;String&gt; getTags() { return tags; }&#10;    public int getReadTime() { return readTime; }&#10;    public String getCreatedAt() { return createdAt; }&#10;    public String getUpdatedAt() { return updatedAt; }&#10;    public JsonElement getAuthor() { return author; }&#10;&#10;    // Setters&#10;    public void setId(String id) { this.id = id; }&#10;    public void setCategoryId(String categoryId) { this.categoryId = categoryId; }&#10;    public void setTitle(String title) { this.title = title; }&#10;    public void setContent(String content) { this.content = content; }&#10;    public void setFileId(String fileId) { this.fileId = fileId; }&#10;    public void setAuthor(JsonElement author) { this.author = author; }&#10;    public void setDescription(String description) { this.description = description; }&#10;    public void setFile(MediaFile file) { this.file = file; }&#10;    public void setCategory(Category category) { this.category = category; }&#10;    public void setLikes(int likes) { this.likes = likes; }&#10;    public void setViews(int views) { this.views = views; }&#10;    public void setTags(List&lt;String&gt; tags) { this.tags = tags; }&#10;    public void setReadTime(int readTime) { this.readTime = readTime; }&#10;    public void setCreatedAt(String createdAt) { this.createdAt = createdAt; }&#10;    public void setUpdatedAt(String updatedAt) { this.updatedAt = updatedAt; }&#10;&#10;    // Get image URL helper method&#10;    public String getImageUrl() {&#10;        return file != null ? file.getFileUrl() : null;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.notby.data.model;&#10;&#10;import com.google.gson.JsonElement;&#10;import com.google.gson.JsonObject;&#10;import com.google.gson.annotations.SerializedName;&#10;import java.util.List;&#10;&#10;public class Article {&#10;    @SerializedName(&quot;_id&quot;)&#10;    private String id;&#10;&#10;    @SerializedName(&quot;CategoryId&quot;)&#10;    private String categoryId;&#10;&#10;    @SerializedName(&quot;Title&quot;)&#10;    private String title;&#10;&#10;    @SerializedName(&quot;Content&quot;)&#10;    private String content;&#10;&#10;    @SerializedName(&quot;FileId&quot;)&#10;    private String fileId;&#10;&#10;    @SerializedName(&quot;Author&quot;)&#10;    private JsonElement author; // can be String, object, or null&#10;&#10;    @SerializedName(&quot;Description&quot;)&#10;    private String description;&#10;&#10;    @SerializedName(&quot;File&quot;)&#10;    private MediaFile file;&#10;&#10;    @SerializedName(&quot;Category&quot;)&#10;    private Category category;&#10;&#10;    @SerializedName(&quot;Likes&quot;)&#10;    private int likes;&#10;&#10;    @SerializedName(&quot;Views&quot;)&#10;    private int views;&#10;&#10;    @SerializedName(&quot;Tags&quot;)&#10;    private List&lt;String&gt; tags;&#10;&#10;    @SerializedName(&quot;ReadTime&quot;)&#10;    private int readTime;&#10;&#10;    @SerializedName(&quot;created_at&quot;)&#10;    private String createdAt;&#10;&#10;    @SerializedName(&quot;updated_at&quot;)&#10;    private String updatedAt;&#10;&#10;    // Getters&#10;    public String getId() { return id; }&#10;    public String getCategoryId() { return categoryId; }&#10;    public String getTitle() { return title; }&#10;    public String getContent() { return content; }&#10;    public String getFileId() { return fileId; }&#10;    public String getAuthorId() {&#10;        if (author == null || author.isJsonNull()) return null;&#10;        if (author.isJsonPrimitive()) {&#10;            try { return author.getAsString(); } catch (Exception e) { return null; }&#10;        }&#10;        if (author.isJsonObject()) {&#10;            JsonObject obj = author.getAsJsonObject();&#10;            if (obj.has(&quot;_id&quot;) &amp;&amp; !obj.get(&quot;_id&quot;).isJsonNull()) return obj.get(&quot;_id&quot;).getAsString();&#10;            if (obj.has(&quot;id&quot;) &amp;&amp; !obj.get(&quot;id&quot;).isJsonNull()) return obj.get(&quot;id&quot;).getAsString();&#10;        }&#10;        return null;&#10;    }&#10;    public String getDescription() { return description; }&#10;    public MediaFile getFile() { return file; }&#10;    public Category getCategory() { return category; }&#10;    public int getLikes() { return likes; }&#10;    public int getViews() { return views; }&#10;    public List&lt;String&gt; getTags() { return tags; }&#10;    public int getReadTime() { return readTime; }&#10;    public String getCreatedAt() { return createdAt; }&#10;    public String getUpdatedAt() { return updatedAt; }&#10;    public JsonElement getAuthor() { return author; }&#10;&#10;    // Setters&#10;    public void setId(String id) { this.id = id; }&#10;    public void setCategoryId(String categoryId) { this.categoryId = categoryId; }&#10;    public void setTitle(String title) { this.title = title; }&#10;    public void setContent(String content) { this.content = content; }&#10;    public void setFileId(String fileId) { this.fileId = fileId; }&#10;    public void setAuthor(JsonElement author) { this.author = author; }&#10;    public void setDescription(String description) { this.description = description; }&#10;    public void setFile(MediaFile file) { this.file = file; }&#10;    public void setCategory(Category category) { this.category = category; }&#10;    public void setLikes(int likes) { this.likes = likes; }&#10;    public void setViews(int views) { this.views = views; }&#10;    public void setTags(List&lt;String&gt; tags) { this.tags = tags; }&#10;    public void setReadTime(int readTime) { this.readTime = readTime; }&#10;    public void setCreatedAt(String createdAt) { this.createdAt = createdAt; }&#10;    public void setUpdatedAt(String updatedAt) { this.updatedAt = updatedAt; }&#10;&#10;    // Get image URL helper method&#10;    public String getImageUrl() {&#10;        return file != null ? file.getFileUrl() : null;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/library/LibraryActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/library/LibraryActivity.java" />
              <option name="originalContent" value="package com.example.notby.ui.library;&#10;&#10;import android.app.Dialog;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.viewpager2.widget.ViewPager2;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.Article;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#10;import com.google.android.material.tabs.TabLayout;&#10;import com.google.android.material.tabs.TabLayoutMediator;&#10;import com.google.gson.JsonPrimitive;&#10;&#10;import java.util.ArrayList;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class LibraryActivity extends AppCompatActivity {&#10;    private ViewPager2 viewPager;&#10;    private TabLayout tabLayout;&#10;    private LibraryPagerAdapter pagerAdapter;&#10;    private FloatingActionButton fabCreateArticle;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_library);&#10;&#10;        fabCreateArticle = findViewById(R.id.fabCreateArticle);&#10;&#10;        setupToolbar();&#10;        setupViewPager();&#10;        setupTabs();&#10;        setupFab();&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Thư viện&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupViewPager() {&#10;        viewPager = findViewById(R.id.viewPager);&#10;        pagerAdapter = new LibraryPagerAdapter(this);&#10;        viewPager.setAdapter(pagerAdapter);&#10;&#10;        viewPager.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {&#10;            @Override&#10;            public void onPageSelected(int position) {&#10;                super.onPageSelected(position);&#10;                if (position == 0) {&#10;                    fabCreateArticle.setVisibility(View.VISIBLE);&#10;                } else {&#10;                    fabCreateArticle.setVisibility(View.GONE);&#10;                }&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupTabs() {&#10;        tabLayout = findViewById(R.id.tabLayout);&#10;        String[] tabTitles = new String[]{&quot;Bài viết&quot;, &quot;Video&quot;, &quot;Chuyên gia&quot;, &quot;Tài liệu&quot;};&#10;&#10;        new TabLayoutMediator(tabLayout, viewPager, (tab, position) -&gt; {&#10;            tab.setText(tabTitles[position]);&#10;        }).attach();&#10;    }&#10;&#10;    private void setupFab() {&#10;        fabCreateArticle.setOnClickListener(v -&gt; showCreateArticleDialog());&#10;    }&#10;&#10;    private void showCreateArticleDialog() {&#10;        Dialog dialog = new Dialog(this);&#10;        dialog.setContentView(R.layout.layout_create_article);&#10;&#10;        EditText editTextTitle = dialog.findViewById(R.id.editTextTitle);&#10;        EditText editTextDescription = dialog.findViewById(R.id.editTextDescription);&#10;        EditText editTextContent = dialog.findViewById(R.id.editTextContent);&#10;        Button buttonAddImage = dialog.findViewById(R.id.buttonAddImage);&#10;        Button buttonSubmit = dialog.findViewById(R.id.buttonSubmit);&#10;&#10;        buttonSubmit.setOnClickListener(v -&gt; {&#10;            String title = editTextTitle.getText().toString();&#10;            String description = editTextDescription.getText().toString();&#10;            String content = editTextContent.getText().toString();&#10;&#10;            if (title.isEmpty() || description.isEmpty() || content.isEmpty()) {&#10;                Toast.makeText(this, &quot;Vui lòng điền đầy đủ thông tin&quot;, Toast.LENGTH_SHORT).show();&#10;                return;&#10;            }&#10;&#10;            Article article = new Article();&#10;            article.setTitle(title);&#10;            article.setDescription(description);&#10;            article.setContent(content);&#10;            article.setCategoryId(&quot;68dd571d5a1978661c574b2d&quot;); // Default category ID for &quot;Sức khỏe&quot;&#10;            article.setAuthor(new JsonPrimitive(getAuthorId()));&#10;            article.setLikes(0);&#10;            article.setViews(0);&#10;            article.setReadTime(5); // Default read time in minutes&#10;            article.setTags(new ArrayList&lt;&gt;()); // Empty tags list for now&#10;&#10;            createArticle(article, dialog);&#10;        });&#10;&#10;        dialog.show();&#10;    }&#10;&#10;    private String getAuthorId() {&#10;        TokenManager tokenManager = new TokenManager(this);&#10;        return tokenManager.getUserIdFromToken();&#10;    }&#10;&#10;    private void createArticle(Article article, Dialog dialog) {&#10;        ApiClient.getArticleApi().createArticle(article).enqueue(new Callback&lt;ApiResponse&lt;Article&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;Article&gt;&gt; call, Response&lt;ApiResponse&lt;Article&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isStatus()) {&#10;                    Toast.makeText(LibraryActivity.this, &quot;Tạo bài viết thành công&quot;, Toast.LENGTH_SHORT).show();&#10;                    dialog.dismiss();&#10;                    // Reload the list in the fragment&#10;                    pagerAdapter.notifyDataSetChanged();&#10;                } else {&#10;                    Toast.makeText(LibraryActivity.this, &quot;Lỗi khi tạo bài viết&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;Article&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(LibraryActivity.this, &quot;Lỗi kết nối: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.notby.ui.library;&#10;&#10;import android.app.Dialog;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Button;&#10;import android.widget.EditText;&#10;import android.widget.Toast;&#10;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.viewpager2.widget.ViewPager2;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.Article;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.google.android.material.floatingactionbutton.FloatingActionButton;&#10;import com.google.android.material.tabs.TabLayout;&#10;import com.google.android.material.tabs.TabLayoutMediator;&#10;import com.google.gson.JsonPrimitive;&#10;&#10;import java.util.ArrayList;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class LibraryActivity extends AppCompatActivity {&#10;    private ViewPager2 viewPager;&#10;    private TabLayout tabLayout;&#10;    private LibraryPagerAdapter pagerAdapter;&#10;    private FloatingActionButton fabCreateArticle;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_library);&#10;&#10;        fabCreateArticle = findViewById(R.id.fabCreateArticle);&#10;&#10;        setupToolbar();&#10;        setupViewPager();&#10;        setupTabs();&#10;        setupFab();&#10;    }&#10;&#10;    private void setupToolbar() {&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;        if (getSupportActionBar() != null) {&#10;            getSupportActionBar().setTitle(&quot;Thư viện&quot;);&#10;            getSupportActionBar().setDisplayHomeAsUpEnabled(true);&#10;        }&#10;    }&#10;&#10;    private void setupViewPager() {&#10;        viewPager = findViewById(R.id.viewPager);&#10;        pagerAdapter = new LibraryPagerAdapter(this);&#10;        viewPager.setAdapter(pagerAdapter);&#10;&#10;        viewPager.registerOnPageChangeCallback(new ViewPager2.OnPageChangeCallback() {&#10;            @Override&#10;            public void onPageSelected(int position) {&#10;                super.onPageSelected(position);&#10;                if (position == 0) {&#10;                    fabCreateArticle.setVisibility(View.VISIBLE);&#10;                } else {&#10;                    fabCreateArticle.setVisibility(View.GONE);&#10;                }&#10;            }&#10;        });&#10;    }&#10;&#10;    private void setupTabs() {&#10;        tabLayout = findViewById(R.id.tabLayout);&#10;        String[] tabTitles = new String[]{&quot;Bài viết&quot;, &quot;Video&quot;, &quot;Chuyên gia&quot;, &quot;Tài liệu&quot;};&#10;&#10;        new TabLayoutMediator(tabLayout, viewPager, (tab, position) -&gt; {&#10;            tab.setText(tabTitles[position]);&#10;        }).attach();&#10;    }&#10;&#10;    private void setupFab() {&#10;        fabCreateArticle.setOnClickListener(v -&gt; showCreateArticleDialog());&#10;    }&#10;&#10;    private void showCreateArticleDialog() {&#10;        Dialog dialog = new Dialog(this);&#10;        dialog.setContentView(R.layout.layout_create_article);&#10;&#10;        EditText editTextTitle = dialog.findViewById(R.id.editTextTitle);&#10;        EditText editTextDescription = dialog.findViewById(R.id.editTextDescription);&#10;        EditText editTextContent = dialog.findViewById(R.id.editTextContent);&#10;        Button buttonAddImage = dialog.findViewById(R.id.buttonAddImage);&#10;        Button buttonSubmit = dialog.findViewById(R.id.buttonSubmit);&#10;&#10;        buttonSubmit.setOnClickListener(v -&gt; {&#10;            String title = editTextTitle.getText().toString();&#10;            String description = editTextDescription.getText().toString();&#10;            String content = editTextContent.getText().toString();&#10;&#10;            if (title.isEmpty() || description.isEmpty() || content.isEmpty()) {&#10;                Toast.makeText(this, &quot;Vui lòng điền đầy đủ thông tin&quot;, Toast.LENGTH_SHORT).show();&#10;                return;&#10;            }&#10;&#10;            Article article = new Article();&#10;            article.setTitle(title);&#10;            article.setDescription(description);&#10;            article.setContent(content);&#10;            article.setCategoryId(&quot;68dd571d5a1978661c574b2d&quot;); // Default category ID for &quot;Sức khỏe&quot;&#10;            article.setAuthor(new JsonPrimitive(getAuthorId()));&#10;            article.setLikes(0);&#10;            article.setViews(0);&#10;            article.setReadTime(5); // Default read time in minutes&#10;            article.setTags(new ArrayList&lt;&gt;()); // Empty tags list for now&#10;&#10;            createArticle(article, dialog);&#10;        });&#10;&#10;        dialog.show();&#10;    }&#10;&#10;    private String getAuthorId() {&#10;        TokenManager tokenManager = new TokenManager(this);&#10;        return tokenManager.getUserIdFromToken();&#10;    }&#10;&#10;    private void createArticle(Article article, Dialog dialog) {&#10;        ApiClient.getArticleApi().createArticle(article).enqueue(new Callback&lt;ApiResponse&lt;Article&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;Article&gt;&gt; call, Response&lt;ApiResponse&lt;Article&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null &amp;&amp; response.body().isStatus()) {&#10;                    Toast.makeText(LibraryActivity.this, &quot;Tạo bài viết thành công&quot;, Toast.LENGTH_SHORT).show();&#10;                    dialog.dismiss();&#10;                    // Reload the list in the fragment&#10;                    pagerAdapter.notifyDataSetChanged();&#10;                } else {&#10;                    Toast.makeText(LibraryActivity.this, &quot;Lỗi khi tạo bài viết&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;Article&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(LibraryActivity.this, &quot;Lỗi kết nối: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    public boolean onSupportNavigateUp() {&#10;        onBackPressed();&#10;        return true;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>