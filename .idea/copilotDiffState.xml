<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/TokenManager.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/TokenManager.java" />
              <option name="originalContent" value="package com.example.notby.data;&#10;&#10;import android.content.Context;&#10;import android.content.SharedPreferences;&#10;import android.util.Base64;&#10;import org.json.JSONObject;&#10;&#10;public class TokenManager {&#10;    private static final String PREF_NAME = &quot;NotByPrefs&quot;;&#10;    private static final String KEY_JWT_TOKEN = &quot;jwt_token&quot;;&#10;    private static final String KEY_USER_EMAIL = &quot;user_email&quot;;&#10;    private static final String KEY_USER_NAME = &quot;user_name&quot;;&#10;    private static final String KEY_USER_ID = &quot;user_id&quot;;&#10;&#10;    private SharedPreferences sharedPreferences;&#10;    private SharedPreferences.Editor editor;&#10;&#10;    public TokenManager(Context context) {&#10;        sharedPreferences = context.getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);&#10;        editor = sharedPreferences.edit();&#10;    }&#10;&#10;    public void saveToken(String token) {&#10;        editor.putString(KEY_JWT_TOKEN, token);&#10;        editor.apply();&#10;    }&#10;&#10;    public String getToken() {&#10;        return sharedPreferences.getString(KEY_JWT_TOKEN, null);&#10;    }&#10;&#10;    public void saveUserData(String userId, String email, String name) {&#10;        editor.putString(KEY_USER_ID, userId);&#10;        editor.putString(KEY_USER_EMAIL, email);&#10;        editor.putString(KEY_USER_NAME, name);&#10;        editor.apply();&#10;    }&#10;&#10;    public String getUserId() {&#10;        return sharedPreferences.getString(KEY_USER_ID, null);&#10;    }&#10;&#10;    public String getUserEmail() {&#10;        return sharedPreferences.getString(KEY_USER_EMAIL, null);&#10;    }&#10;&#10;    public String getUserName() {&#10;        return sharedPreferences.getString(KEY_USER_NAME, null);&#10;    }&#10;&#10;    public boolean isLoggedIn() {&#10;        return getToken() != null;&#10;    }&#10;&#10;    public void clearSession() {&#10;        editor.clear();&#10;        editor.apply();&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.notby.data;&#10;&#10;import android.content.Context;&#10;import android.content.SharedPreferences;&#10;import android.util.Base64;&#10;import org.json.JSONObject;&#10;&#10;public class TokenManager {&#10;    private static final String PREF_NAME = &quot;NotByPrefs&quot;;&#10;    private static final String KEY_JWT_TOKEN = &quot;jwt_token&quot;;&#10;    private static final String KEY_USER_EMAIL = &quot;user_email&quot;;&#10;    private static final String KEY_USER_NAME = &quot;user_name&quot;;&#10;    private static final String KEY_USER_ID = &quot;user_id&quot;;&#10;    private static final String KEY_CHILD_ID = &quot;child_id&quot;;&#10;&#10;    private SharedPreferences sharedPreferences;&#10;    private SharedPreferences.Editor editor;&#10;&#10;    public TokenManager(Context context) {&#10;        sharedPreferences = context.getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE);&#10;        editor = sharedPreferences.edit();&#10;    }&#10;&#10;    public void saveToken(String token) {&#10;        editor.putString(KEY_JWT_TOKEN, token);&#10;        editor.apply();&#10;    }&#10;&#10;    public String getToken() {&#10;        return sharedPreferences.getString(KEY_JWT_TOKEN, null);&#10;    }&#10;&#10;    public void saveUserData(String userId, String email, String name) {&#10;        editor.putString(KEY_USER_ID, userId);&#10;        editor.putString(KEY_USER_EMAIL, email);&#10;        editor.putString(KEY_USER_NAME, name);&#10;        editor.apply();&#10;    }&#10;&#10;    public String getUserId() {&#10;        return sharedPreferences.getString(KEY_USER_ID, null);&#10;    }&#10;&#10;    public String getUserEmail() {&#10;        return sharedPreferences.getString(KEY_USER_EMAIL, null);&#10;    }&#10;&#10;    public String getUserName() {&#10;        return sharedPreferences.getString(KEY_USER_NAME, null);&#10;    }&#10;&#10;    /**&#10;     * Extract user ID from JWT token&#10;     * @return user ID from token or null if extraction fails&#10;     */&#10;    public String getUserIdFromToken() {&#10;        String token = getToken();&#10;        if (token == null || token.isEmpty()) {&#10;            return null;&#10;        }&#10;        &#10;        try {&#10;            // JWT token has 3 parts separated by dots: header.payload.signature&#10;            String[] tokenParts = token.split(&quot;\\.&quot;);&#10;            if (tokenParts.length != 3) {&#10;                return null;&#10;            }&#10;            &#10;            // Decode the payload (second part)&#10;            String payload = tokenParts[1];&#10;            &#10;            // Add padding if needed for Base64 decoding&#10;            while (payload.length() % 4 != 0) {&#10;                payload += &quot;=&quot;;&#10;            }&#10;            &#10;            // Decode Base64&#10;            byte[] decodedBytes = Base64.decode(payload, Base64.URL_SAFE);&#10;            String decodedPayload = new String(decodedBytes);&#10;            &#10;            // Parse JSON&#10;            JSONObject payloadJson = new JSONObject(decodedPayload);&#10;            &#10;            // Try common user ID field names&#10;            String userId = null;&#10;            if (payloadJson.has(&quot;userId&quot;)) {&#10;                userId = payloadJson.getString(&quot;userId&quot;);&#10;            } else if (payloadJson.has(&quot;user_id&quot;)) {&#10;                userId = payloadJson.getString(&quot;user_id&quot;);&#10;            } else if (payloadJson.has(&quot;id&quot;)) {&#10;                userId = payloadJson.getString(&quot;id&quot;);&#10;            } else if (payloadJson.has(&quot;sub&quot;)) {&#10;                userId = payloadJson.getString(&quot;sub&quot;);&#10;            }&#10;            &#10;            return userId;&#10;            &#10;        } catch (Exception e) {&#10;            return null;&#10;        }&#10;    }&#10;&#10;    public void saveChildId(String childId) {&#10;        editor.putString(KEY_CHILD_ID, childId);&#10;        editor.apply();&#10;    }&#10;&#10;    public String getChildId() {&#10;        return sharedPreferences.getString(KEY_CHILD_ID, null);&#10;    }&#10;&#10;    public boolean isLoggedIn() {&#10;        return getToken() != null;&#10;    }&#10;&#10;    public void clearSession() {&#10;        editor.clear();&#10;        editor.apply();&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/remote/ApiClient.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/data/remote/ApiClient.java" />
              <option name="originalContent" value="package com.example.notby.data.remote;&#10;&#10;import retrofit2.Retrofit;&#10;import retrofit2.converter.gson.GsonConverterFactory;&#10;import android.content.Context;&#10;import okhttp3.Interceptor;&#10;import okhttp3.OkHttpClient;&#10;import okhttp3.Request;&#10;import okhttp3.Response;&#10;import java.io.IOException;&#10;import com.example.notby.data.TokenManager;&#10;import com.google.gson.Gson;&#10;import com.google.gson.GsonBuilder;&#10;&#10;public class ApiClient {&#10;    private static final String BASE_URL = &quot;https://notby-be-8q9y.onrender.com/&quot;;&#10;    private static Retrofit retrofit = null;&#10;    private static ForumPostApi forumPostApi = null;&#10;    private static ForumCommentApi forumCommentApi = null;&#10;    private static UserApi userApi = null;&#10;    private static MediafileApi mediafileApi = null;&#10;    private static CloudinaryApi cloudinaryApi = null;&#10;    private static BabiesApi babiesApi = null;&#10;    private static DiaryEntriesApi diaryEntriesApi = null;&#10;&#10;&#10;    public static Retrofit getClient() {&#10;        if (retrofit == null) {&#10;            // Create Gson with lenient parsing to handle potential field mismatches&#10;            Gson gson = new GsonBuilder()&#10;                    .setLenient()&#10;                    .serializeNulls()&#10;                    .create();&#10;                    &#10;            retrofit = new Retrofit.Builder()&#10;                    .baseUrl(BASE_URL)&#10;                    .addConverterFactory(GsonConverterFactory.create(gson))&#10;                    .build();&#10;        }&#10;        return retrofit;&#10;    }&#10;&#10;    // Build a Retrofit client that attaches Authorization header from TokenManager (if token exists)&#10;    public static Retrofit getClientWithAuth(Context context) {&#10;        TokenManager tokenManager = new TokenManager(context.getApplicationContext());&#10;        final String token = tokenManager.getToken();&#10;&#10;        OkHttpClient client = new OkHttpClient.Builder()&#10;                .addInterceptor(new Interceptor() {&#10;                    @Override&#10;                    public Response intercept(Chain chain) throws IOException {&#10;                        Request original = chain.request();&#10;                        Request.Builder builder = original.newBuilder();&#10;                        if (token != null &amp;&amp; !token.isEmpty()) {&#10;                            builder.header(&quot;Authorization&quot;, &quot;Bearer &quot; + token);&#10;                            // Log a masked token and URL for debugging&#10;                            String mask = token.length() &gt; 8 ? token.substring(token.length()-8) : token;&#10;                            android.util.Log.d(&quot;ApiClient&quot;, &quot;Request: &quot; + original.url() + &quot; Authorization: ****&quot; + mask);&#10;                        }&#10;                        Request request = builder.build();&#10;                        return chain.proceed(request);&#10;                    }&#10;                })&#10;                .build();&#10;&#10;        // Create Gson with lenient parsing to handle potential field mismatches&#10;        Gson gson = new GsonBuilder()&#10;                .setLenient()&#10;                .serializeNulls()&#10;                .create();&#10;&#10;        return new Retrofit.Builder()&#10;                .baseUrl(BASE_URL)&#10;                .client(client)&#10;                .addConverterFactory(GsonConverterFactory.create(gson))&#10;                .build();&#10;    }&#10;&#10;    // Convenience: get BabiesApi with auth (useful when endpoints require JWT)&#10;    public static BabiesApi getBabiesApi(Context context) {&#10;        return getClientWithAuth(context).create(BabiesApi.class);&#10;    }&#10;    public static BabiesApi getBabiesApi() {&#10;        if (babiesApi == null) {&#10;            babiesApi = getClient().create(BabiesApi.class);&#10;        }&#10;        return babiesApi;&#10;    }&#10;&#10;    public static DiaryEntriesApi getDiaryEntriesApi(Context context) {&#10;        if (diaryEntriesApi == null) {&#10;            diaryEntriesApi = getClientWithAuth(context).create(DiaryEntriesApi.class);&#10;        }&#10;        return diaryEntriesApi;&#10;    }&#10;&#10;    public static ForumPostApi getForumPostApi() {&#10;        if (forumPostApi == null) {&#10;            forumPostApi = getClient().create(ForumPostApi.class);&#10;        }&#10;        return forumPostApi;&#10;    }&#10;    public static ForumCommentApi getForumCommentApi() {&#10;        if (forumCommentApi == null) {&#10;            forumCommentApi = getClient().create(ForumCommentApi.class);&#10;        }&#10;        return forumCommentApi;&#10;    }&#10;&#10;&#10;    public static UserApi getUserApi() {&#10;        if (userApi == null) {&#10;            userApi = getClient().create(UserApi.class);&#10;        }&#10;        return userApi;&#10;    }&#10;&#10;    public static MediafileApi getMediafileApi() {&#10;        if (mediafileApi == null) {&#10;            mediafileApi = getClient().create(MediafileApi.class);&#10;        }&#10;        return mediafileApi;&#10;    }&#10;&#10;    public static CloudinaryApi getCloudinaryApi() {&#10;        if (cloudinaryApi == null) {&#10;            cloudinaryApi = getClient().create(CloudinaryApi.class);&#10;        }&#10;        return cloudinaryApi;&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.example.notby.data.remote;&#10;&#10;import retrofit2.Retrofit;&#10;import retrofit2.converter.gson.GsonConverterFactory;&#10;import android.content.Context;&#10;import okhttp3.Interceptor;&#10;import okhttp3.OkHttpClient;&#10;import okhttp3.Request;&#10;import okhttp3.Response;&#10;import java.io.IOException;&#10;import com.example.notby.data.TokenManager;&#10;import com.google.gson.Gson;&#10;import com.google.gson.GsonBuilder;&#10;&#10;public class ApiClient {&#10;    private static final String BASE_URL = &quot;https://notby-be-8q9y.onrender.com/&quot;;&#10;    private static Retrofit retrofit = null;&#10;    private static ForumPostApi forumPostApi = null;&#10;    private static ForumCommentApi forumCommentApi = null;&#10;    private static UserApi userApi = null;&#10;    private static MediafileApi mediafileApi = null;&#10;    private static CloudinaryApi cloudinaryApi = null;&#10;    private static BabiesApi babiesApi = null;&#10;    private static DiaryEntriesApi diaryEntriesApi = null;&#10;&#10;&#10;    public static Retrofit getClient() {&#10;        if (retrofit == null) {&#10;            // Create Gson with lenient parsing to handle potential field mismatches&#10;            Gson gson = new GsonBuilder()&#10;                    .setLenient()&#10;                    .serializeNulls()&#10;                    .create();&#10;                    &#10;            retrofit = new Retrofit.Builder()&#10;                    .baseUrl(BASE_URL)&#10;                    .addConverterFactory(GsonConverterFactory.create(gson))&#10;                    .build();&#10;        }&#10;        return retrofit;&#10;    }&#10;&#10;    // Build a Retrofit client that attaches Authorization header from TokenManager (if token exists)&#10;    public static Retrofit getClientWithAuth(Context context) {&#10;        TokenManager tokenManager = new TokenManager(context.getApplicationContext());&#10;        final String token = tokenManager.getToken();&#10;&#10;        OkHttpClient client = new OkHttpClient.Builder()&#10;                .addInterceptor(new Interceptor() {&#10;                    @Override&#10;                    public Response intercept(Chain chain) throws IOException {&#10;                        Request original = chain.request();&#10;                        Request.Builder builder = original.newBuilder();&#10;                        if (token != null &amp;&amp; !token.isEmpty()) {&#10;                            builder.header(&quot;Authorization&quot;, &quot;Bearer &quot; + token);&#10;                            // Log a masked token and URL for debugging&#10;                            String mask = token.length() &gt; 8 ? token.substring(token.length()-8) : token;&#10;                            android.util.Log.d(&quot;ApiClient&quot;, &quot;Request: &quot; + original.url() + &quot; Authorization: ****&quot; + mask);&#10;                        }&#10;                        Request request = builder.build();&#10;                        return chain.proceed(request);&#10;                    }&#10;                })&#10;                .build();&#10;&#10;        // Create Gson with lenient parsing to handle potential field mismatches&#10;        Gson gson = new GsonBuilder()&#10;                .setLenient()&#10;                .serializeNulls()&#10;                .create();&#10;&#10;        return new Retrofit.Builder()&#10;                .baseUrl(BASE_URL)&#10;                .client(client)&#10;                .addConverterFactory(GsonConverterFactory.create(gson))&#10;                .build();&#10;    }&#10;&#10;    // Convenience: get BabiesApi with auth (useful when endpoints require JWT)&#10;    public static BabiesApi getBabiesApi(Context context) {&#10;        return getClientWithAuth(context).create(BabiesApi.class);&#10;    }&#10;    public static BabiesApi getBabiesApi() {&#10;        if (babiesApi == null) {&#10;            babiesApi = getClient().create(BabiesApi.class);&#10;        }&#10;        return babiesApi;&#10;    }&#10;&#10;    public static DiaryEntriesApi getDiaryEntriesApi(Context context) {&#10;        if (diaryEntriesApi == null) {&#10;            diaryEntriesApi = getClientWithAuth(context).create(DiaryEntriesApi.class);&#10;        }&#10;        return diaryEntriesApi;&#10;    }&#10;&#10;    public static ForumPostApi getForumPostApi() {&#10;        if (forumPostApi == null) {&#10;            forumPostApi = getClient().create(ForumPostApi.class);&#10;        }&#10;        return forumPostApi;&#10;    }&#10;    public static ForumCommentApi getForumCommentApi() {&#10;        if (forumCommentApi == null) {&#10;            forumCommentApi = getClient().create(ForumCommentApi.class);&#10;        }&#10;        return forumCommentApi;&#10;    }&#10;&#10;&#10;    public static UserApi getUserApi() {&#10;        if (userApi == null) {&#10;            userApi = getClient().create(UserApi.class);&#10;        }&#10;        return userApi;&#10;    }&#10;&#10;    public static MediafileApi getMediafileApi() {&#10;        if (mediafileApi == null) {&#10;            mediafileApi = getClient().create(MediafileApi.class);&#10;        }&#10;        return mediafileApi;&#10;    }&#10;&#10;    public static CloudinaryApi getCloudinaryApi() {&#10;        if (cloudinaryApi == null) {&#10;            cloudinaryApi = getClient().create(CloudinaryApi.class);&#10;        }&#10;        return cloudinaryApi;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/baby/BabyListActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/baby/BabyListActivity.java" />
              <option name="originalContent" value="package com.example.notby.ui.baby;&#10;&#10;import android.content.DialogInterface;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Toast;&#10;&#10;import androidx.annotation.Nullable;&#10;import androidx.appcompat.app.AlertDialog;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.Baby;&#10;import com.example.notby.data.model.BabiesResponse;&#10;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.example.notby.data.remote.BabiesApi;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class BabyListActivity extends AppCompatActivity implements BabyAdapter.OnBabyDeletedListener {&#10;&#10;    private static final int ADD_BABY_REQUEST = 1;&#10;&#10;    private RecyclerView recyclerView;&#10;    private BabyAdapter adapter;&#10;    private TokenManager tokenManager;&#10;    private List&lt;Baby&gt; babyList;&#10;&#10;    @Override&#10;    protected void onCreate(@Nullable Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_baby_list);&#10;&#10;        recyclerView = findViewById(R.id.babies_recycler_view);&#10;        recyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;&#10;        tokenManager = new TokenManager(this);&#10;&#10;        loadBabies();&#10;&#10;        findViewById(R.id.add_baby_button).setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, AddBabyActivity.class);&#10;            startActivityForResult(intent, ADD_BABY_REQUEST);&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {&#10;        super.onActivityResult(requestCode, resultCode, data);&#10;        if (requestCode == ADD_BABY_REQUEST &amp;&amp; resultCode == RESULT_OK) {&#10;            loadBabies();&#10;        }&#10;    }&#10;&#10;    private void loadBabies() {&#10;        String parentId = tokenManager.getUserId();&#10;        if (parentId == null) {&#10;            Toast.makeText(this, &quot;User not logged in&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        BabiesApi apiService = ApiClient.getBabiesApi(this);&#10;        Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call = apiService.findAll(parentId);&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;BabiesResponse&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, Response&lt;ApiResponse&lt;BabiesResponse&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    BabiesResponse babiesResponse = response.body().getData();&#10;                    if (babiesResponse != null &amp;&amp; babiesResponse.getBabies() != null) {&#10;                        babyList = babiesResponse.getBabies();&#10;                        if (!babyList.isEmpty()) {&#10;                            adapter = new BabyAdapter(babyList, BabyListActivity.this);&#10;                            recyclerView.setAdapter(adapter);&#10;                        }&#10;                    }&#10;                } else {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Failed to load babies&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(BabyListActivity.this, &quot;Error: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    public void onBabyDeleted(Baby baby) {&#10;        new AlertDialog.Builder(this)&#10;                .setTitle(&quot;Xóa bé&quot;)&#10;                .setMessage(&quot;Bạn có chắc chắn muốn xóa bé &quot; + baby.getFirstName() + &quot;?&quot;)&#10;                .setPositiveButton(&quot;Xóa&quot;, (dialog, which) -&gt; deleteBaby(baby))&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#10;                .show();&#10;    }&#10;&#10;    private void deleteBaby(Baby baby) {&#10;        BabiesApi apiService = ApiClient.getBabiesApi(this);&#10;        Call&lt;ApiResponse&lt;Void&gt;&gt; call = apiService.deleteBaby(baby.getId());&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;Void&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;Void&gt;&gt; call, Response&lt;ApiResponse&lt;Void&gt;&gt; response) {&#10;                if (response.isSuccessful()) {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Xóa bé thành công&quot;, Toast.LENGTH_SHORT).show();&#10;                    babyList.remove(baby);&#10;                    adapter.notifyDataSetChanged();&#10;                } else {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Xóa bé thất bại&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;Void&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(BabyListActivity.this, &quot;Lỗi: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.notby.ui.baby;&#10;&#10;import android.content.DialogInterface;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.view.View;&#10;import android.widget.Toast;&#10;&#10;import androidx.annotation.Nullable;&#10;import androidx.appcompat.app.AlertDialog;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.recyclerview.widget.LinearLayoutManager;&#10;import androidx.recyclerview.widget.RecyclerView;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.Baby;&#10;import com.example.notby.data.model.BabiesResponse;&#10;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.example.notby.data.remote.BabiesApi;&#10;&#10;import java.util.List;&#10;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;public class BabyListActivity extends AppCompatActivity implements BabyAdapter.OnBabyDeletedListener {&#10;&#10;    private static final int ADD_BABY_REQUEST = 1;&#10;&#10;    private RecyclerView recyclerView;&#10;    private BabyAdapter adapter;&#10;    private TokenManager tokenManager;&#10;    private List&lt;Baby&gt; babyList;&#10;&#10;    @Override&#10;    protected void onCreate(@Nullable Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_baby_list);&#10;&#10;        recyclerView = findViewById(R.id.babies_recycler_view);&#10;        recyclerView.setLayoutManager(new LinearLayoutManager(this));&#10;&#10;        tokenManager = new TokenManager(this);&#10;&#10;        loadBabies();&#10;&#10;        findViewById(R.id.add_baby_button).setOnClickListener(v -&gt; {&#10;            Intent intent = new Intent(this, AddBabyActivity.class);&#10;            startActivityForResult(intent, ADD_BABY_REQUEST);&#10;        });&#10;    }&#10;&#10;    @Override&#10;    protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {&#10;        super.onActivityResult(requestCode, resultCode, data);&#10;        if (requestCode == ADD_BABY_REQUEST &amp;&amp; resultCode == RESULT_OK) {&#10;            loadBabies();&#10;        }&#10;    }&#10;&#10;    private void loadBabies() {&#10;        // Get JWT token and extract user ID from it&#10;        String token = tokenManager.getToken();&#10;        if (token == null || token.isEmpty()) {&#10;            Toast.makeText(this, &quot;User not logged in - No token&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        // Extract user ID from JWT token&#10;        String parentId = tokenManager.getUserIdFromToken();&#10;        if (parentId == null) {&#10;            Toast.makeText(this, &quot;User not logged in - Invalid token&quot;, Toast.LENGTH_SHORT).show();&#10;            return;&#10;        }&#10;&#10;        BabiesApi apiService = ApiClient.getBabiesApi(); // Use non-authenticated client&#10;        Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call = apiService.findAll(parentId);&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;BabiesResponse&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, Response&lt;ApiResponse&lt;BabiesResponse&gt;&gt; response) {&#10;                if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                    BabiesResponse babiesResponse = response.body().getData();&#10;                    if (babiesResponse != null &amp;&amp; babiesResponse.getBabies() != null) {&#10;                        babyList = babiesResponse.getBabies();&#10;                        if (!babyList.isEmpty()) {&#10;                            adapter = new BabyAdapter(babyList, BabyListActivity.this);&#10;                            recyclerView.setAdapter(adapter);&#10;                        }&#10;                    }&#10;                } else {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Failed to load babies&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(BabyListActivity.this, &quot;Error: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    @Override&#10;    public void onBabyDeleted(Baby baby) {&#10;        new AlertDialog.Builder(this)&#10;                .setTitle(&quot;Xóa bé&quot;)&#10;                .setMessage(&quot;Bạn có chắc chắn muốn xóa bé &quot; + baby.getFirstName() + &quot;?&quot;)&#10;                .setPositiveButton(&quot;Xóa&quot;, (dialog, which) -&gt; deleteBaby(baby))&#10;                .setNegativeButton(&quot;Hủy&quot;, null)&#10;                .show();&#10;    }&#10;&#10;    private void deleteBaby(Baby baby) {&#10;        BabiesApi apiService = ApiClient.getBabiesApi(); // Use non-authenticated client&#10;        Call&lt;ApiResponse&lt;Void&gt;&gt; call = apiService.deleteBaby(baby.getId());&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;Void&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(Call&lt;ApiResponse&lt;Void&gt;&gt; call, Response&lt;ApiResponse&lt;Void&gt;&gt; response) {&#10;                if (response.isSuccessful()) {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Xóa bé thành công&quot;, Toast.LENGTH_SHORT).show();&#10;                    babyList.remove(baby);&#10;                    adapter.notifyDataSetChanged();&#10;                } else {&#10;                    Toast.makeText(BabyListActivity.this, &quot;Xóa bé thất bại&quot;, Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(Call&lt;ApiResponse&lt;Void&gt;&gt; call, Throwable t) {&#10;                Toast.makeText(BabyListActivity.this, &quot;Lỗi: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/dashboard/DashboardActivity.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/notby/ui/dashboard/DashboardActivity.java" />
              <option name="originalContent" value="package com.example.notby.ui.dashboard;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.PopupMenu;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.OnBackPressedCallback;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.ActionBarDrawerToggle;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.core.view.GravityCompat;&#10;import androidx.drawerlayout.widget.DrawerLayout;&#10;import androidx.fragment.app.Fragment;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.Baby;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.BabiesResponse;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.example.notby.data.remote.BabiesApi;&#10;import com.example.notby.ui.baby.BabyListActivity;&#10;import com.example.notby.ui.diary.DiaryFragment;&#10;import com.google.android.material.navigation.NavigationView;&#10;import okhttp3.ResponseBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;&#10;public class DashboardActivity extends AppCompatActivity implements NavigationView.OnNavigationItemSelectedListener {&#10;&#10;    private DrawerLayout drawerLayout;&#10;    private TokenManager tokenManager;&#10;    private String currentBabyId = null;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_dashboard);&#10;&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;&#10;        drawerLayout = findViewById(R.id.drawer_layout);&#10;        NavigationView navigationView = findViewById(R.id.nav_view);&#10;        navigationView.setNavigationItemSelectedListener(this);&#10;&#10;        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(this, drawerLayout, toolbar,&#10;                R.string.navigation_drawer_open, R.string.navigation_drawer_close);&#10;        drawerLayout.addDrawerListener(toggle);&#10;        toggle.syncState();&#10;&#10;        // Handle system back (replace deprecated onBackPressed)&#10;        getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {&#10;            @Override&#10;            public void handleOnBackPressed() {&#10;                if (drawerLayout.isDrawerOpen(GravityCompat.START)) {&#10;                    drawerLayout.closeDrawer(GravityCompat.START);&#10;                } else {&#10;                    // default behavior&#10;                    finish();&#10;                }&#10;            }&#10;        });&#10;&#10;        tokenManager = new TokenManager(this);&#10;&#10;        // Try to load child's data and populate nav header&#10;        loadChildForCurrentUser();&#10;&#10;        // Set OverviewFragment as the default screen&#10;        if (savedInstanceState == null) {&#10;            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, new OverviewFragment()).commit();&#10;            navigationView.setCheckedItem(R.id.nav_overview);&#10;        }&#10;&#10;        // --- Handle Footer Click ---&#10;        View navFooter = navigationView.findViewById(R.id.nav_footer_root);&#10;        navFooter.setOnClickListener(this::showFooterPopupMenu);&#10;&#10;        // Wire header clicks (if header already populated it will be overwritten later)&#10;        View header = navigationView.getHeaderView(0);&#10;        if (header != null) {&#10;            View childCard = header.findViewById(R.id.child_card_root);&#10;            View childAction = header.findViewById(R.id.child_action);&#10;            View.OnClickListener headerClick = v -&gt; {&#10;                Intent intent = new Intent(DashboardActivity.this, BabyListActivity.class);&#10;                startActivity(intent);&#10;            };&#10;            if (childCard != null) childCard.setOnClickListener(headerClick);&#10;            if (childAction != null) childAction.setOnClickListener(headerClick);&#10;        }&#10;    }&#10;&#10;    private void loadChildForCurrentUser() {&#10;        String userId = tokenManager.getUserId();&#10;        if (userId == null) return;&#10;&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Loading babies for parentId=&quot; + userId);&#10;&#10;        // Log token presence (masked) for debug&#10;        String token = tokenManager.getToken();&#10;        if (token == null || token.isEmpty()) {&#10;            Log.w(&quot;DashboardActivity&quot;, &quot;No JWT token stored (token == null)&quot;);&#10;        } else {&#10;            String tail = token.length() &gt; 8 ? token.substring(token.length() - 8) : token;&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;JWT present (masked) ****&quot; + tail);&#10;        }&#10;&#10;        // Use non-authenticated API client for baby operations&#10;        BabiesApi babiesApi = ApiClient.getBabiesApi();&#10;&#10;        // If we have a saved childId, try fetching it directly&#10;        // Trong DashboardActivity.java -&gt; loadChildForCurrentUser()&#10;&#10;        String savedChildId = tokenManager.getChildId();&#10;        if (savedChildId != null) {&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Found saved childId=&quot; + savedChildId + &quot;, fetching via /babies/{id}&quot;);&#10;&#10;            Call&lt;ApiResponse&lt;Baby&gt;&gt; byIdCall = babiesApi.getById(savedChildId);&#10;&#10;            byIdCall.enqueue(new Callback&lt;ApiResponse&lt;Baby&gt;&gt;() {&#10;                @Override&#10;                public void onResponse(@NonNull Call&lt;ApiResponse&lt;Baby&gt;&gt; call, @NonNull Response&lt;ApiResponse&lt;Baby&gt;&gt; response) {&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        ApiResponse&lt;Baby&gt; apiResponse = response.body();&#10;                        Baby baby = apiResponse.getData();&#10;&#10;                        if (baby != null) {&#10;                            currentBabyId = baby.getId();&#10;                            updateNavHeaderWithBaby(baby);&#10;                            Log.d(&quot;DashboardActivity&quot;, &quot;Loaded baby by id=&quot; + currentBabyId);&#10;                        } else {&#10;                            Log.w(&quot;DashboardActivity&quot;, &quot;Response body missing 'data' field, falling back to findAll&quot;);&#10;                            fetchBabiesByParent(babiesApi, userId);&#10;                        }&#10;                    } else {&#10;                        Log.w(&quot;DashboardActivity&quot;, &quot;getById didn't return valid baby, falling back to findAll&quot;);&#10;                        fetchBabiesByParent(babiesApi, userId);&#10;                    }&#10;                }&#10;&#10;                @Override&#10;                public void onFailure(@NonNull Call&lt;ApiResponse&lt;Baby&gt;&gt; call, @NonNull Throwable t) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;getById failed&quot;, t);&#10;                    fetchBabiesByParent(babiesApi, userId);&#10;                }&#10;            });&#10;        } else {&#10;            fetchBabiesByParent(babiesApi, userId);&#10;        }&#10;    }&#10;&#10;&#10;    // Trong file: DashboardActivity.java&#10;&#10;    private void fetchBabiesByParent(BabiesApi babiesApi, String parentId) {&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Fetching babies for parentId: &quot; + parentId);&#10;&#10;        // Use non-authenticated API client to fetch babies directly&#10;        Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call = babiesApi.findAll(parentId);&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;BabiesResponse&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(@NonNull Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, @NonNull Response&lt;ApiResponse&lt;BabiesResponse&gt;&gt; response) {&#10;                try {&#10;                    Log.d(&quot;DashboardActivity&quot;, &quot;Response received - Status: &quot; + response.isSuccessful() + &quot;, Code: &quot; + response.code());&#10;&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        ApiResponse&lt;BabiesResponse&gt; apiResponse = response.body();&#10;                        Log.d(&quot;DashboardActivity&quot;, &quot;ApiResponse status: &quot; + apiResponse.isStatus());&#10;&#10;                        BabiesResponse babiesResponse = apiResponse.getData();&#10;&#10;                        if (babiesResponse != null) {&#10;                            Log.d(&quot;DashboardActivity&quot;, &quot;BabiesResponse received, babies count: &quot; +&#10;                                (babiesResponse.getBabies() != null ? babiesResponse.getBabies().size() : &quot;null&quot;));&#10;&#10;                            if (babiesResponse.getBabies() != null &amp;&amp; !babiesResponse.getBabies().isEmpty()) {&#10;                                List&lt;Baby&gt; babies = babiesResponse.getBabies();&#10;                                Baby baby = babies.get(0);&#10;&#10;                                Log.d(&quot;DashboardActivity&quot;, &quot;Baby received - ID: &quot; + baby.getId() +&#10;                                    &quot;, FirstName: &quot; + baby.getFirstName() +&#10;                                    &quot;, LastName: &quot; + baby.getLastName());&#10;&#10;                                // persist child id&#10;                                tokenManager.saveChildId(baby.getId());&#10;                                currentBabyId = baby.getId();&#10;                                updateNavHeaderWithBaby(baby);&#10;&#10;                                Log.d(&quot;DashboardActivity&quot;, &quot;Successfully updated nav header with baby&quot;);&#10;                            } else {&#10;                                Log.w(&quot;DashboardActivity&quot;, &quot;Babies list is null or empty&quot;);&#10;                                attemptRawInspect(babiesApi, parentId);&#10;                            }&#10;                        } else {&#10;                            Log.w(&quot;DashboardActivity&quot;, &quot;BabiesResponse data is null&quot;);&#10;                            attemptRawInspect(babiesApi, parentId);&#10;                        }&#10;                    } else {&#10;                        // Server returned error (4xx, 5xx)&#10;                        try (ResponseBody responseBody = response.errorBody()) {&#10;                            String err = responseBody != null ? responseBody.string() : &quot;&lt;empty&gt;&quot;;&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;API error fetching babies: code=&quot; + response.code() + &quot; body=&quot; + err);&#10;                        } catch (IOException e) {&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Error reading response body&quot;, e);&#10;                        }&#10;                        attemptRawInspect(babiesApi, parentId);&#10;                    }&#10;                } catch (Exception e) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Exception in onResponse: &quot; + e.getClass().getSimpleName() + &quot; - &quot; + e.getMessage(), e);&#10;                    Toast.makeText(DashboardActivity.this, &quot;Error processing baby data: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(@NonNull Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, @NonNull Throwable t) {&#10;                Log.e(&quot;DashboardActivity&quot;, &quot;API call failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;                Toast.makeText(DashboardActivity.this, &quot;Network error loading baby data: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void attemptRawInspect(BabiesApi babiesApi, String userId) {&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Attempting fallback raw call to inspect response shape&quot;);&#10;        try {&#10;            Call&lt;Object&gt; raw = babiesApi.findAllRaw(userId);&#10;            raw.enqueue(new Callback&lt;Object&gt;() {&#10;                @Override&#10;                public void onResponse(@NonNull Call&lt;Object&gt; call, @NonNull Response&lt;Object&gt; response) {&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        Log.d(&quot;DashboardActivity&quot;, &quot;Raw response body: &quot; + response.body());&#10;                        // parsing handled elsewhere previously; keep simple here&#10;                    } else {&#10;                        // Ensure proper use of try-with-resources for ResponseBody in all instances&#10;                        try (ResponseBody responseBody = response.errorBody()) {&#10;                            String err = responseBody != null ? responseBody.string() : &quot;&lt;empty&gt;&quot;;&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Raw API error code=&quot; + response.code() + &quot; body=&quot; + err);&#10;                        } catch (IOException e) {&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Error reading raw errorBody&quot;, e);&#10;                        }&#10;                    }&#10;                }&#10;&#10;                @Override&#10;                public void onFailure(@NonNull Call&lt;Object&gt; call, @NonNull Throwable t) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Raw API call failed&quot;, t);&#10;                }&#10;            });&#10;        } catch (Exception ex) {&#10;            Log.e(&quot;DashboardActivity&quot;, &quot;Fallback raw call failed&quot;, ex);&#10;        }&#10;    }&#10;&#10;    private void updateNavHeaderWithBaby(Baby baby) {&#10;        try {&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Updating nav header with baby: &quot; + baby.getId());&#10;&#10;            NavigationView navigationView = findViewById(R.id.nav_view);&#10;            if (navigationView == null) {&#10;                Log.w(&quot;DashboardActivity&quot;, &quot;NavigationView is null&quot;);&#10;                return;&#10;            }&#10;&#10;            View header = navigationView.getHeaderView(0);&#10;            if (header == null) {&#10;                Log.w(&quot;DashboardActivity&quot;, &quot;Navigation header view is null&quot;);&#10;                return;&#10;            }&#10;&#10;            TextView childName = header.findViewById(R.id.child_name);&#10;            TextView childBirthday = header.findViewById(R.id.child_birthday);&#10;            TextView childInitial = header.findViewById(R.id.child_initial);&#10;&#10;            // Safely handle baby data&#10;            String firstName = baby.getFirstName();&#10;            String lastName = baby.getLastName();&#10;            String dob = baby.getDob();&#10;&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Baby data - FirstName: &quot; + firstName + &quot;, LastName: &quot; + lastName + &quot;, DOB: &quot; + dob);&#10;&#10;            if (childName != null) {&#10;                try {&#10;                    String fullName;&#10;                    if (firstName != null &amp;&amp; lastName != null) {&#10;                        fullName = getString(R.string.child_name_template, firstName, lastName);&#10;                    } else if (firstName != null) {&#10;                        fullName = firstName;&#10;                    } else {&#10;                        fullName = &quot;Unknown&quot;;&#10;                    }&#10;                    childName.setText(fullName);&#10;                    Log.d(&quot;DashboardActivity&quot;, &quot;Set child name: &quot; + fullName);&#10;                } catch (Exception e) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Error setting child name: &quot; + e.getMessage(), e);&#10;                    childName.setText(firstName != null ? firstName : &quot;Unknown&quot;);&#10;                }&#10;            }&#10;&#10;            if (childBirthday != null) {&#10;                String birthday = dob != null ? dob : &quot;&quot;;&#10;                childBirthday.setText(birthday);&#10;                Log.d(&quot;DashboardActivity&quot;, &quot;Set child birthday: &quot; + birthday);&#10;            }&#10;&#10;            if (childInitial != null) {&#10;                String initial = &quot;&quot;;&#10;                if (firstName != null &amp;&amp; !firstName.isEmpty()) {&#10;                    initial = firstName.substring(0, 1).toUpperCase();&#10;                }&#10;                childInitial.setText(initial);&#10;                Log.d(&quot;DashboardActivity&quot;, &quot;Set child initial: &quot; + initial);&#10;            }&#10;&#10;            // update current fields&#10;            currentBabyId = baby.getId();&#10;&#10;            // ensure header actions use current id&#10;            View childCard = header.findViewById(R.id.child_card_root);&#10;            View childAction = header.findViewById(R.id.child_action);&#10;            View.OnClickListener headerClick = v -&gt; {&#10;                Intent intent = new Intent(DashboardActivity.this, BabyListActivity.class);&#10;                startActivity(intent);&#10;            };&#10;            if (childCard != null) childCard.setOnClickListener(headerClick);&#10;            if (childAction != null) childAction.setOnClickListener(headerClick);&#10;&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Successfully updated nav header&quot;);&#10;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DashboardActivity&quot;, &quot;Exception in updateNavHeaderWithBaby: &quot; + e.getClass().getSimpleName() + &quot; - &quot; + e.getMessage(), e);&#10;            Toast.makeText(this, &quot;Error updating baby information: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    private void showFooterPopupMenu(View view) {&#10;        PopupMenu popup = new PopupMenu(this, view);&#10;        popup.getMenuInflater().inflate(R.menu.footer_popup_menu, popup.getMenu());&#10;        popup.setOnMenuItemClickListener(item -&gt; {&#10;            int itemId = item.getItemId();&#10;            if (itemId == R.id.action_logout) {&#10;                // Handle logout&#10;                Toast.makeText(this, &quot;Đăng xuất&quot;, Toast.LENGTH_SHORT).show();&#10;                return true;&#10;            } else if (itemId == R.id.action_settings) {&#10;                // Handle settings&#10;                Toast.makeText(this, &quot;Cài đặt&quot;, Toast.LENGTH_SHORT).show();&#10;                return true;&#10;            }&#10;            // Add other cases for other menu items&#10;            return false;&#10;        });&#10;        popup.show();&#10;    }&#10;&#10;    @Override&#10;    public boolean onNavigationItemSelected(@NonNull MenuItem item) {&#10;        Fragment selectedFragment = null;&#10;        int itemId = item.getItemId();&#10;&#10;        if (itemId == R.id.nav_overview) {&#10;            selectedFragment = new OverviewFragment();&#10;        } else if (itemId == R.id.nav_stats) {&#10;            // selectedFragment = new StatsFragment(); // Create and use your other fragments here&#10;            Toast.makeText(this, &quot;Thống kê&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (itemId == R.id.nav_development_diary) {&#10;            selectedFragment = new DiaryFragment(); // Load the DiaryFragment&#10;        } else if (itemId == R.id.nav_add_photo) {&#10;            // Quick action: Add photo - pass child id&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Add photo for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;                // Intent intent = new Intent(this, AddPhotoActivity.class);&#10;                // intent.putExtra(&quot;childId&quot;, currentBabyId);&#10;                // startActivity(intent);&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } else if (itemId == R.id.nav_add_note) {&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Add note for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;                // start note activity with childId&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } else if (itemId == R.id.nav_share) {&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Share memory for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } // Add other else-if blocks for other menu items&#10;&#10;        if (selectedFragment != null) {&#10;            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, selectedFragment).commit();&#10;        }&#10;&#10;        drawerLayout.closeDrawer(GravityCompat.START);&#10;        return true;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.notby.ui.dashboard;&#10;&#10;import android.content.Intent;&#10;import android.os.Bundle;&#10;import android.util.Log;&#10;import android.view.MenuItem;&#10;import android.view.View;&#10;import android.widget.PopupMenu;&#10;import android.widget.TextView;&#10;import android.widget.Toast;&#10;&#10;import androidx.activity.OnBackPressedCallback;&#10;import androidx.annotation.NonNull;&#10;import androidx.appcompat.app.ActionBarDrawerToggle;&#10;import androidx.appcompat.app.AppCompatActivity;&#10;import androidx.appcompat.widget.Toolbar;&#10;import androidx.core.view.GravityCompat;&#10;import androidx.drawerlayout.widget.DrawerLayout;&#10;import androidx.fragment.app.Fragment;&#10;&#10;import com.example.notby.R;&#10;import com.example.notby.data.TokenManager;&#10;import com.example.notby.data.model.Baby;&#10;import com.example.notby.data.model.ApiResponse;&#10;import com.example.notby.data.model.BabiesResponse;&#10;import com.example.notby.data.remote.ApiClient;&#10;import com.example.notby.data.remote.BabiesApi;&#10;import com.example.notby.ui.baby.BabyListActivity;&#10;import com.example.notby.ui.diary.DiaryFragment;&#10;import com.google.android.material.navigation.NavigationView;&#10;import okhttp3.ResponseBody;&#10;import retrofit2.Call;&#10;import retrofit2.Callback;&#10;import retrofit2.Response;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;&#10;public class DashboardActivity extends AppCompatActivity implements NavigationView.OnNavigationItemSelectedListener {&#10;&#10;    private DrawerLayout drawerLayout;&#10;    private TokenManager tokenManager;&#10;    private String currentBabyId = null;&#10;&#10;    @Override&#10;    protected void onCreate(Bundle savedInstanceState) {&#10;        super.onCreate(savedInstanceState);&#10;        setContentView(R.layout.activity_dashboard);&#10;&#10;        Toolbar toolbar = findViewById(R.id.toolbar);&#10;        setSupportActionBar(toolbar);&#10;&#10;        drawerLayout = findViewById(R.id.drawer_layout);&#10;        NavigationView navigationView = findViewById(R.id.nav_view);&#10;        navigationView.setNavigationItemSelectedListener(this);&#10;&#10;        ActionBarDrawerToggle toggle = new ActionBarDrawerToggle(this, drawerLayout, toolbar,&#10;                R.string.navigation_drawer_open, R.string.navigation_drawer_close);&#10;        drawerLayout.addDrawerListener(toggle);&#10;        toggle.syncState();&#10;&#10;        // Handle system back (replace deprecated onBackPressed)&#10;        getOnBackPressedDispatcher().addCallback(this, new OnBackPressedCallback(true) {&#10;            @Override&#10;            public void handleOnBackPressed() {&#10;                if (drawerLayout.isDrawerOpen(GravityCompat.START)) {&#10;                    drawerLayout.closeDrawer(GravityCompat.START);&#10;                } else {&#10;                    // default behavior&#10;                    finish();&#10;                }&#10;            }&#10;        });&#10;&#10;        tokenManager = new TokenManager(this);&#10;&#10;        // Try to load child's data and populate nav header&#10;        loadChildForCurrentUser();&#10;&#10;        // Set OverviewFragment as the default screen&#10;        if (savedInstanceState == null) {&#10;            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, new OverviewFragment()).commit();&#10;            navigationView.setCheckedItem(R.id.nav_overview);&#10;        }&#10;&#10;        // --- Handle Footer Click ---&#10;        View navFooter = navigationView.findViewById(R.id.nav_footer_root);&#10;        navFooter.setOnClickListener(this::showFooterPopupMenu);&#10;&#10;        // Wire header clicks (if header already populated it will be overwritten later)&#10;        View header = navigationView.getHeaderView(0);&#10;        if (header != null) {&#10;            View childCard = header.findViewById(R.id.child_card_root);&#10;            View childAction = header.findViewById(R.id.child_action);&#10;            View.OnClickListener headerClick = v -&gt; {&#10;                Intent intent = new Intent(DashboardActivity.this, BabyListActivity.class);&#10;                startActivity(intent);&#10;            };&#10;            if (childCard != null) childCard.setOnClickListener(headerClick);&#10;            if (childAction != null) childAction.setOnClickListener(headerClick);&#10;        }&#10;    }&#10;&#10;    private void loadChildForCurrentUser() {&#10;        // Get JWT token and extract user ID from it&#10;        String token = tokenManager.getToken();&#10;        if (token == null || token.isEmpty()) {&#10;            Log.w(&quot;DashboardActivity&quot;, &quot;No JWT token stored - user not logged in&quot;);&#10;            return;&#10;        }&#10;&#10;        // Extract user ID from JWT token&#10;        String userId = tokenManager.getUserIdFromToken();&#10;        if (userId == null) {&#10;            Log.e(&quot;DashboardActivity&quot;, &quot;Failed to extract user ID from JWT token&quot;);&#10;            return;&#10;        }&#10;&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Loading babies for parentId=&quot; + userId + &quot; (extracted from JWT)&quot;);&#10;&#10;        // Log token presence (masked) for debug&#10;        String tail = token.length() &gt; 8 ? token.substring(token.length() - 8) : token;&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;JWT present (masked) ****&quot; + tail);&#10;&#10;        // Use non-authenticated API client for baby operations&#10;        BabiesApi babiesApi = ApiClient.getBabiesApi();&#10;&#10;        // If we have a saved childId, try fetching it directly&#10;        String savedChildId = tokenManager.getChildId();&#10;        if (savedChildId != null) {&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Found saved childId=&quot; + savedChildId + &quot;, fetching via /babies/{id}&quot;);&#10;&#10;            Call&lt;ApiResponse&lt;Baby&gt;&gt; byIdCall = babiesApi.getById(savedChildId);&#10;&#10;            byIdCall.enqueue(new Callback&lt;ApiResponse&lt;Baby&gt;&gt;() {&#10;                @Override&#10;                public void onResponse(@NonNull Call&lt;ApiResponse&lt;Baby&gt;&gt; call, @NonNull Response&lt;ApiResponse&lt;Baby&gt;&gt; response) {&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        ApiResponse&lt;Baby&gt; apiResponse = response.body();&#10;                        Baby baby = apiResponse.getData();&#10;&#10;                        if (baby != null) {&#10;                            currentBabyId = baby.getId();&#10;                            updateNavHeaderWithBaby(baby);&#10;                            Log.d(&quot;DashboardActivity&quot;, &quot;Loaded baby by id=&quot; + currentBabyId);&#10;                        } else {&#10;                            Log.w(&quot;DashboardActivity&quot;, &quot;Response body missing 'data' field, falling back to findAll&quot;);&#10;                            fetchBabiesByParent(babiesApi, userId);&#10;                        }&#10;                    } else {&#10;                        Log.w(&quot;DashboardActivity&quot;, &quot;getById didn't return valid baby, falling back to findAll&quot;);&#10;                        fetchBabiesByParent(babiesApi, userId);&#10;                    }&#10;                }&#10;&#10;                @Override&#10;                public void onFailure(@NonNull Call&lt;ApiResponse&lt;Baby&gt;&gt; call, @NonNull Throwable t) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;getById failed&quot;, t);&#10;                    fetchBabiesByParent(babiesApi, userId);&#10;                }&#10;            });&#10;        } else {&#10;            fetchBabiesByParent(babiesApi, userId);&#10;        }&#10;    }&#10;&#10;&#10;    // Trong file: DashboardActivity.java&#10;&#10;    private void fetchBabiesByParent(BabiesApi babiesApi, String parentId) {&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Fetching babies for parentId: &quot; + parentId);&#10;&#10;        // Use non-authenticated API client to fetch babies directly&#10;        Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call = babiesApi.findAll(parentId);&#10;&#10;        call.enqueue(new Callback&lt;ApiResponse&lt;BabiesResponse&gt;&gt;() {&#10;            @Override&#10;            public void onResponse(@NonNull Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, @NonNull Response&lt;ApiResponse&lt;BabiesResponse&gt;&gt; response) {&#10;                try {&#10;                    Log.d(&quot;DashboardActivity&quot;, &quot;Response received - Status: &quot; + response.isSuccessful() + &quot;, Code: &quot; + response.code());&#10;&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        ApiResponse&lt;BabiesResponse&gt; apiResponse = response.body();&#10;                        Log.d(&quot;DashboardActivity&quot;, &quot;ApiResponse status: &quot; + apiResponse.isStatus());&#10;&#10;                        BabiesResponse babiesResponse = apiResponse.getData();&#10;&#10;                        if (babiesResponse != null) {&#10;                            Log.d(&quot;DashboardActivity&quot;, &quot;BabiesResponse received, babies count: &quot; +&#10;                                (babiesResponse.getBabies() != null ? babiesResponse.getBabies().size() : &quot;null&quot;));&#10;&#10;                            if (babiesResponse.getBabies() != null &amp;&amp; !babiesResponse.getBabies().isEmpty()) {&#10;                                List&lt;Baby&gt; babies = babiesResponse.getBabies();&#10;                                Baby baby = babies.get(0);&#10;&#10;                                Log.d(&quot;DashboardActivity&quot;, &quot;Baby received - ID: &quot; + baby.getId() +&#10;                                    &quot;, FirstName: &quot; + baby.getFirstName() +&#10;                                    &quot;, LastName: &quot; + baby.getLastName());&#10;&#10;                                // persist child id&#10;                                tokenManager.saveChildId(baby.getId());&#10;                                currentBabyId = baby.getId();&#10;                                updateNavHeaderWithBaby(baby);&#10;&#10;                                Log.d(&quot;DashboardActivity&quot;, &quot;Successfully updated nav header with baby&quot;);&#10;                            } else {&#10;                                Log.w(&quot;DashboardActivity&quot;, &quot;Babies list is null or empty&quot;);&#10;                                attemptRawInspect(babiesApi, parentId);&#10;                            }&#10;                        } else {&#10;                            Log.w(&quot;DashboardActivity&quot;, &quot;BabiesResponse data is null&quot;);&#10;                            attemptRawInspect(babiesApi, parentId);&#10;                        }&#10;                    } else {&#10;                        // Server returned error (4xx, 5xx)&#10;                        try (ResponseBody responseBody = response.errorBody()) {&#10;                            String err = responseBody != null ? responseBody.string() : &quot;&lt;empty&gt;&quot;;&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;API error fetching babies: code=&quot; + response.code() + &quot; body=&quot; + err);&#10;                        } catch (IOException e) {&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Error reading response body&quot;, e);&#10;                        }&#10;                        attemptRawInspect(babiesApi, parentId);&#10;                    }&#10;                } catch (Exception e) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Exception in onResponse: &quot; + e.getClass().getSimpleName() + &quot; - &quot; + e.getMessage(), e);&#10;                    Toast.makeText(DashboardActivity.this, &quot;Error processing baby data: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;                }&#10;            }&#10;&#10;            @Override&#10;            public void onFailure(@NonNull Call&lt;ApiResponse&lt;BabiesResponse&gt;&gt; call, @NonNull Throwable t) {&#10;                Log.e(&quot;DashboardActivity&quot;, &quot;API call failure: &quot; + t.getClass().getSimpleName() + &quot; - &quot; + t.getMessage(), t);&#10;                Toast.makeText(DashboardActivity.this, &quot;Network error loading baby data: &quot; + t.getMessage(), Toast.LENGTH_SHORT).show();&#10;            }&#10;        });&#10;    }&#10;&#10;    private void attemptRawInspect(BabiesApi babiesApi, String userId) {&#10;        Log.d(&quot;DashboardActivity&quot;, &quot;Attempting fallback raw call to inspect response shape&quot;);&#10;        try {&#10;            Call&lt;Object&gt; raw = babiesApi.findAllRaw(userId);&#10;            raw.enqueue(new Callback&lt;Object&gt;() {&#10;                @Override&#10;                public void onResponse(@NonNull Call&lt;Object&gt; call, @NonNull Response&lt;Object&gt; response) {&#10;                    if (response.isSuccessful() &amp;&amp; response.body() != null) {&#10;                        Log.d(&quot;DashboardActivity&quot;, &quot;Raw response body: &quot; + response.body());&#10;                        // parsing handled elsewhere previously; keep simple here&#10;                    } else {&#10;                        // Ensure proper use of try-with-resources for ResponseBody in all instances&#10;                        try (ResponseBody responseBody = response.errorBody()) {&#10;                            String err = responseBody != null ? responseBody.string() : &quot;&lt;empty&gt;&quot;;&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Raw API error code=&quot; + response.code() + &quot; body=&quot; + err);&#10;                        } catch (IOException e) {&#10;                            Log.e(&quot;DashboardActivity&quot;, &quot;Error reading raw errorBody&quot;, e);&#10;                        }&#10;                    }&#10;                }&#10;&#10;                @Override&#10;                public void onFailure(@NonNull Call&lt;Object&gt; call, @NonNull Throwable t) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Raw API call failed&quot;, t);&#10;                }&#10;            });&#10;        } catch (Exception ex) {&#10;            Log.e(&quot;DashboardActivity&quot;, &quot;Fallback raw call failed&quot;, ex);&#10;        }&#10;    }&#10;&#10;    private void updateNavHeaderWithBaby(Baby baby) {&#10;        try {&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Updating nav header with baby: &quot; + baby.getId());&#10;&#10;            NavigationView navigationView = findViewById(R.id.nav_view);&#10;            if (navigationView == null) {&#10;                Log.w(&quot;DashboardActivity&quot;, &quot;NavigationView is null&quot;);&#10;                return;&#10;            }&#10;&#10;            View header = navigationView.getHeaderView(0);&#10;            if (header == null) {&#10;                Log.w(&quot;DashboardActivity&quot;, &quot;Navigation header view is null&quot;);&#10;                return;&#10;            }&#10;&#10;            TextView childName = header.findViewById(R.id.child_name);&#10;            TextView childBirthday = header.findViewById(R.id.child_birthday);&#10;            TextView childInitial = header.findViewById(R.id.child_initial);&#10;&#10;            // Safely handle baby data&#10;            String firstName = baby.getFirstName();&#10;            String lastName = baby.getLastName();&#10;            String dob = baby.getDob();&#10;&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Baby data - FirstName: &quot; + firstName + &quot;, LastName: &quot; + lastName + &quot;, DOB: &quot; + dob);&#10;&#10;            if (childName != null) {&#10;                try {&#10;                    String fullName;&#10;                    if (firstName != null &amp;&amp; lastName != null) {&#10;                        fullName = getString(R.string.child_name_template, firstName, lastName);&#10;                    } else if (firstName != null) {&#10;                        fullName = firstName;&#10;                    } else {&#10;                        fullName = &quot;Unknown&quot;;&#10;                    }&#10;                    childName.setText(fullName);&#10;                    Log.d(&quot;DashboardActivity&quot;, &quot;Set child name: &quot; + fullName);&#10;                } catch (Exception e) {&#10;                    Log.e(&quot;DashboardActivity&quot;, &quot;Error setting child name: &quot; + e.getMessage(), e);&#10;                    childName.setText(firstName != null ? firstName : &quot;Unknown&quot;);&#10;                }&#10;            }&#10;&#10;            if (childBirthday != null) {&#10;                String birthday = dob != null ? dob : &quot;&quot;;&#10;                childBirthday.setText(birthday);&#10;                Log.d(&quot;DashboardActivity&quot;, &quot;Set child birthday: &quot; + birthday);&#10;            }&#10;&#10;            if (childInitial != null) {&#10;                String initial = &quot;&quot;;&#10;                if (firstName != null &amp;&amp; !firstName.isEmpty()) {&#10;                    initial = firstName.substring(0, 1).toUpperCase();&#10;                }&#10;                childInitial.setText(initial);&#10;                Log.d(&quot;DashboardActivity&quot;, &quot;Set child initial: &quot; + initial);&#10;            }&#10;&#10;            // update current fields&#10;            currentBabyId = baby.getId();&#10;&#10;            // ensure header actions use current id&#10;            View childCard = header.findViewById(R.id.child_card_root);&#10;            View childAction = header.findViewById(R.id.child_action);&#10;            View.OnClickListener headerClick = v -&gt; {&#10;                Intent intent = new Intent(DashboardActivity.this, BabyListActivity.class);&#10;                startActivity(intent);&#10;            };&#10;            if (childCard != null) childCard.setOnClickListener(headerClick);&#10;            if (childAction != null) childAction.setOnClickListener(headerClick);&#10;&#10;            Log.d(&quot;DashboardActivity&quot;, &quot;Successfully updated nav header&quot;);&#10;&#10;        } catch (Exception e) {&#10;            Log.e(&quot;DashboardActivity&quot;, &quot;Exception in updateNavHeaderWithBaby: &quot; + e.getClass().getSimpleName() + &quot; - &quot; + e.getMessage(), e);&#10;            Toast.makeText(this, &quot;Error updating baby information: &quot; + e.getMessage(), Toast.LENGTH_SHORT).show();&#10;        }&#10;    }&#10;&#10;    private void showFooterPopupMenu(View view) {&#10;        PopupMenu popup = new PopupMenu(this, view);&#10;        popup.getMenuInflater().inflate(R.menu.footer_popup_menu, popup.getMenu());&#10;        popup.setOnMenuItemClickListener(item -&gt; {&#10;            int itemId = item.getItemId();&#10;            if (itemId == R.id.action_logout) {&#10;                // Handle logout&#10;                Toast.makeText(this, &quot;Đăng xuất&quot;, Toast.LENGTH_SHORT).show();&#10;                return true;&#10;            } else if (itemId == R.id.action_settings) {&#10;                // Handle settings&#10;                Toast.makeText(this, &quot;Cài đặt&quot;, Toast.LENGTH_SHORT).show();&#10;                return true;&#10;            }&#10;            // Add other cases for other menu items&#10;            return false;&#10;        });&#10;        popup.show();&#10;    }&#10;&#10;    @Override&#10;    public boolean onNavigationItemSelected(@NonNull MenuItem item) {&#10;        Fragment selectedFragment = null;&#10;        int itemId = item.getItemId();&#10;&#10;        if (itemId == R.id.nav_overview) {&#10;            selectedFragment = new OverviewFragment();&#10;        } else if (itemId == R.id.nav_stats) {&#10;            // selectedFragment = new StatsFragment(); // Create and use your other fragments here&#10;            Toast.makeText(this, &quot;Thống kê&quot;, Toast.LENGTH_SHORT).show();&#10;        } else if (itemId == R.id.nav_development_diary) {&#10;            selectedFragment = new DiaryFragment(); // Load the DiaryFragment&#10;        } else if (itemId == R.id.nav_add_photo) {&#10;            // Quick action: Add photo - pass child id&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Add photo for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;                // Intent intent = new Intent(this, AddPhotoActivity.class);&#10;                // intent.putExtra(&quot;childId&quot;, currentBabyId);&#10;                // startActivity(intent);&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } else if (itemId == R.id.nav_add_note) {&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Add note for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;                // start note activity with childId&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } else if (itemId == R.id.nav_share) {&#10;            if (currentBabyId != null) {&#10;                Toast.makeText(this, &quot;Share memory for baby: &quot; + currentBabyId, Toast.LENGTH_SHORT).show();&#10;            } else {&#10;                Toast.makeText(this, &quot;Chưa chọn bé&quot;, Toast.LENGTH_SHORT).show();&#10;            }&#10;            drawerLayout.closeDrawer(GravityCompat.START);&#10;            return true;&#10;        } // Add other else-if blocks for other menu items&#10;&#10;        if (selectedFragment != null) {&#10;            getSupportFragmentManager().beginTransaction().replace(R.id.fragment_container, selectedFragment).commit();&#10;        }&#10;&#10;        drawerLayout.closeDrawer(GravityCompat.START);&#10;        return true;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/res/values/post_strings.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/res/values/post_strings.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;resources&gt;&#10;    &lt;!-- Post Detail --&gt;&#10;    &lt;string name=&quot;post_author_format&quot;&gt;By %s&lt;/string&gt;&#10;    &lt;string name=&quot;post_author_anonymous&quot;&gt;By Anonymous&lt;/string&gt;&#10;    &lt;string name=&quot;comment_empty_message&quot;&gt;Please enter a comment&lt;/string&gt;&#10;    &lt;string name=&quot;login_required_message&quot;&gt;Please login to comment&lt;/string&gt;&#10;    &lt;string name=&quot;comment_posted_message&quot;&gt;Comment posted!&lt;/string&gt;&#10;    &lt;string name=&quot;comment_post_failed_message&quot;&gt;Failed to post comment: %s&lt;/string&gt;&#10;    &lt;string name=&quot;comment_post_failed&quot;&gt;Failed to post comment&lt;/string&gt;&#10;    &lt;string name=&quot;comment_liked_message&quot;&gt;Comment liked!&lt;/string&gt;&#10;    &lt;string name=&quot;error_message&quot;&gt;Error: %s&lt;/string&gt;&#10;&lt;/resources&gt;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#10;&lt;resources&gt;&#10;    &lt;!-- Post Detail --&gt;&#10;    &lt;string name=&quot;post_author_format&quot;&gt;By %s&lt;/string&gt;&#10;    &lt;string name=&quot;post_author_anonymous&quot;&gt;By Anonymous&lt;/string&gt;&#10;    &lt;string name=&quot;comment_empty_message&quot;&gt;Please enter a comment&lt;/string&gt;&#10;    &lt;string name=&quot;login_required_message&quot;&gt;Please login to comment&lt;/string&gt;&#10;    &lt;string name=&quot;comment_posted_message&quot;&gt;Comment posted!&lt;/string&gt;&#10;    &lt;string name=&quot;comment_post_failed_message&quot;&gt;Failed to post comment: %s&lt;/string&gt;&#10;    &lt;string name=&quot;comment_post_failed&quot;&gt;Failed to post comment&lt;/string&gt;&#10;    &lt;string name=&quot;comment_liked_message&quot;&gt;Comment liked!&lt;/string&gt;&#10;    &lt;string name=&quot;error_message&quot;&gt;Error: %s&lt;/string&gt;&#10;&lt;/resources&gt;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>